@page "/test"
@using ChatUiT2.Services
@using MongoDB.Bson.Serialization

<div style="height: 48px;">

</div>

<MudText Typo="Typo.h6">Testing purposes ONLY!</MudText>

<MudButton StartIcon="@Icons.Material.Filled.Science" FullWidth OnClick="Testing">Testing</MudButton>

<span>@debug_text</span>

@code {
    [Inject] private TestService testService { get; set; } = null!;
    [Inject] private AuthenticationStateProvider Auth { get; set; } = null!;

    string? debug_text = "Debug text";

    public async Task Testing()
    {
        var isAdmin = await testService._authUserService.TestInRole(["Admin", "User2"]);
        debug_text = isAdmin.ToString();



        var state = await Auth.GetAuthenticationStateAsync();
        if (state.User?.Identity?.IsAuthenticated != true)
        {
            Console.WriteLine("Not authenticated");
            return;
        }


        var name = state.User.Identity.Name;

        state.User.Claims.ToList().ForEach(claim => Console.WriteLine($"{claim.Type}: {claim.Value}"));

        debug_text = state.User.Identity.AuthenticationType;



        StateHasChanged();
    }
}
